<div class="min-h-screen bg-[#121212] flex flex-col">
  <!-- Top Toolbar -->
  <div class="bg-[#1A1A1A] border-b border-[#404040] px-6 py-4">
    <div class="flex items-center justify-between max-w-[1800px] mx-auto">
      <!-- Left: Back button and title -->
      <div class="flex items-center gap-4">
        <button (click)="goBack()" class="btn-ghost" title="Volver">
          <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"/>
          </svg>
        </button>

        <div>
          <input
            [(ngModel)]="boardName"
            class="bg-transparent text-white text-xl font-bold border-none outline-none focus:border-b border-primary"
            placeholder="Nombre de la pizarra"
          />
          <input
            [(ngModel)]="boardDescription"
            class="block bg-transparent text-gray-400 text-sm border-none outline-none focus:border-b border-primary mt-1"
            placeholder="Descripción (opcional)"
          />
        </div>
      </div>

      <!-- Right: Actions -->
      <div class="flex items-center gap-3">
        <button (click)="exportToPNG()" class="btn-outline" title="Exportar PNG">
          <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"/>
          </svg>
          PNG
        </button>

        <button
          *ngIf="boardType() === TacticalBoardType.Animated"
          (click)="exportToGIF()"
          class="btn-outline"
          title="Exportar GIF"
        >
          <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 4v16M17 4v16M3 8h4m10 0h4M3 12h18M3 16h4m10 0h4M4 20h16a1 1 0 001-1V5a1 1 0 00-1-1H4a1 1 0 00-1 1v14a1 1 0 001 1z"/>
          </svg>
          GIF
        </button>

        <button
          (click)="save()"
          class="btn-primary"
          [disabled]="isSaving()"
          title="Guardar"
        >
          <svg *ngIf="!isSaving()" class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7H5a2 2 0 00-2 2v9a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2h-3m-1 4l-3 3m0 0l-3-3m3 3V4"/>
          </svg>
          <span class="spinner" *ngIf="isSaving()"></span>
          {{ isSaving() ? 'Guardando...' : 'Guardar' }}
        </button>
      </div>
    </div>
  </div>

  <!-- Main Content -->
  <div class="flex-1 flex overflow-hidden">
    <!-- Left Sidebar: Tools -->
    <div class="w-20 bg-[#1A1A1A] border-r border-[#404040] flex flex-col items-center py-6 gap-2">
      <button
        *ngFor="let tool of tools"
        (click)="selectTool(tool.id)"
        [class.active]="selectedTool() === tool.id"
        class="tool-btn"
        [title]="tool.label"
      >
        <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <!-- Icons simplified - you would add proper SVG paths here -->
          <circle *ngIf="tool.icon === 'circle'" cx="12" cy="12" r="10"/>
          <rect *ngIf="tool.icon === 'square'" x="4" y="4" width="16" height="16"/>
          <path *ngIf="tool.icon === 'cursor'" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 15l-2 5L9 9l11 4-5 2zm0 0l5 5M7.188 2.239l.777 2.897M5.136 7.965l-2.898-.777M13.95 4.05l-2.122 2.122m-5.657 5.656l-2.12 2.122"/>
          <path *ngIf="tool.icon === 'arrow-right'" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 7l5 5m0 0l-5 5m5-5H6"/>
        </svg>
      </button>

      <!-- Color Palette -->
      <div class="mt-4 pt-4 border-t border-[#404040] space-y-2">
        <button
          *ngFor="let color of colors"
          (click)="selectColor(color)"
          [style.backgroundColor]="color"
          [class.ring-2]="currentColor() === color"
          class="w-10 h-10 rounded-full ring-offset-2 ring-offset-[#1A1A1A] ring-primary hover:scale-110 transition-transform"
          [title]="color"
        ></button>
      </div>
    </div>

    <!-- Center: Canvas Area -->
    <div class="flex-1 flex flex-col bg-[#0D0D0D] overflow-hidden">
      <!-- Field Type Selector -->
      <div class="bg-[#1A1A1A] border-b border-[#404040] px-6 py-3 flex items-center gap-4">
        <span class="text-gray-400 text-sm">Campo:</span>
        <select
          [ngModel]="selectedFieldType()"
          (ngModelChange)="changeFieldType($event)"
          class="input-bold"
        >
          <option [value]="FieldType.Basketball">Basketball</option>
          <option [value]="FieldType.Football">Football</option>
          <option [value]="FieldType.Handball">Handball</option>
          <option [value]="FieldType.Futsal">Futsal</option>
          <option [value]="FieldType.Volleyball">Volleyball</option>
          <option [value]="FieldType.Generic">Genérico</option>
        </select>

        <div class="ml-auto flex items-center gap-3">
          <button (click)="clearCanvas()" class="btn-ghost text-red-500" title="Limpiar canvas">
            <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"/>
            </svg>
          </button>
        </div>
      </div>

      <!-- Canvas Container -->
      <div class="flex-1 flex items-center justify-center p-6 overflow-auto">
        <div #stageContainer class="bg-[#1A1A1A] rounded-lg shadow-2xl"></div>
      </div>
    </div>

    <!-- Right Sidebar: Animation Timeline (if animated) -->
    <div
      *ngIf="boardType() === TacticalBoardType.Animated"
      class="w-80 bg-[#1A1A1A] border-l border-[#404040] flex flex-col"
    >
      <div class="p-4 border-b border-[#404040]">
        <h3 class="text-white font-semibold mb-2">Timeline</h3>

        <!-- Playback Controls -->
        <div class="flex items-center gap-2 mb-4">
          <button
            (click)="playAnimation()"
            [class.btn-secondary]="isPlaying()"
            class="btn-primary flex-1"
          >
            <svg *ngIf="!isPlaying()" class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
              <path d="M6.3 2.841A1.5 1.5 0 004 4.11V15.89a1.5 1.5 0 002.3 1.269l9.344-5.89a1.5 1.5 0 000-2.538L6.3 2.84z"/>
            </svg>
            <svg *ngIf="isPlaying()" class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
              <path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zM7 8a1 1 0 012 0v4a1 1 0 11-2 0V8zm5-1a1 1 0 00-1 1v4a1 1 0 102 0V8a1 1 0 00-1-1z" clip-rule="evenodd"/>
            </svg>
            {{ isPlaying() ? 'Detener' : 'Reproducir' }}
          </button>
        </div>

        <!-- Frame List -->
        <div class="space-y-2">
          <div
            *ngFor="let frame of frames(); let i = index"
            (click)="goToFrame(i)"
            [class.bg-primary]="currentFrame() === i"
            [class.bg-[#121212]]="currentFrame() !== i"
            class="p-3 rounded cursor-pointer hover:bg-opacity-80 transition-colors"
          >
            <div class="flex items-center justify-between">
              <span class="text-white font-medium">Escena {{ i + 1 }}</span>
              <span class="text-gray-400 text-sm">{{ frame.duration }}ms</span>
            </div>
            <div class="text-gray-400 text-xs mt-1">
              {{ frame.elements.length }} elementos
            </div>
          </div>
        </div>

        <!-- Add/Delete Frame -->
        <div class="flex gap-2 mt-4">
          <button (click)="addFrame()" class="btn-primary flex-1">
            <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4"/>
            </svg>
            Nueva Escena
          </button>
          <button
            (click)="deleteFrame()"
            [disabled]="frames().length <= 1"
            class="btn-ghost text-red-500"
            title="Eliminar frame"
          >
            <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"/>
            </svg>
          </button>
        </div>
      </div>
    </div>
  </div>
</div>
