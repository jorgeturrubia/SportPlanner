<!-- Compact Floating Bottom Toolbar -->
<div class="flex items-center gap-1 p-1.5 rounded-full bg-slate-800/90 backdrop-blur-md shadow-2xl border border-white/10">
    
    <!-- Selection Tool -->
    <button (click)="setTool('cursor')" 
        [class.bg-blue-500]="(activeTool$ | async) === 'cursor'" 
        [class.text-white]="(activeTool$ | async) === 'cursor'"
        class="w-9 h-9 rounded-full flex items-center justify-center text-gray-400 hover:text-white hover:bg-white/10 transition-all" title="Seleccionar">
        <svg xmlns="http://www.w3.org/2000/svg" class="w-4 h-4" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 15l-2 5L9 9l11 4-5 2zm0 0l5 5" /></svg>
    </button>

    <!-- Eraser Tool -->
    <button (click)="setTool('eraser')" 
        [class.bg-red-500]="(activeTool$ | async) === 'eraser'" 
        [class.text-white]="(activeTool$ | async) === 'eraser'"
        class="w-9 h-9 rounded-full flex items-center justify-center text-gray-400 hover:text-white hover:bg-white/10 transition-all" title="Borrador">
        <svg xmlns="http://www.w3.org/2000/svg" class="w-4 h-4" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16" /></svg>
    </button>

    <div class="w-px h-6 bg-white/10"></div>

    <!-- Line Tools Dropdown -->
    <div class="relative">
        <button (click)="toggleLineMenu()"
            [class.bg-blue-500]="['pass', 'movement', 'block', 'shot', 'dribbling', 'bounce-pass', 'pivot', 'hand-off', 'cut'].includes((activeTool$ | async) || '')"
            [class.text-white]="['pass', 'movement', 'block', 'shot', 'dribbling', 'bounce-pass', 'pivot', 'hand-off', 'cut'].includes((activeTool$ | async) || '')"
            class="w-9 h-9 rounded-full flex items-center justify-center text-gray-400 hover:text-white hover:bg-white/10 transition-all" title="L√≠neas">
            <svg class="w-4 h-4" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <line x1="5" y1="12" x2="19" y2="12" stroke-linecap="round"/>
                <polyline points="15 8 19 12 15 16" stroke-linecap="round" stroke-linejoin="round"/>
            </svg>
        </button>

        <!-- Dropdown Menu -->
        <div *ngIf="showLineMenu" class="absolute bottom-full left-1/2 -translate-x-1/2 mb-2 bg-slate-800 rounded-xl shadow-2xl border border-white/10 p-2 min-w-[160px] max-h-[300px] overflow-y-auto custom-scrollbar">
            <!-- Standard Tools -->
            <button (click)="selectLineType('movement')" class="w-full flex items-center gap-3 px-3 py-2 rounded-lg hover:bg-white/10 text-gray-300 hover:text-white transition-all text-left">
                <svg class="w-5 h-5 text-green-400" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M5 12h14m-4-4l4 4-4 4" stroke-linecap="round" stroke-linejoin="round"/></svg>
                <span class="text-xs font-medium">Correr</span>
            </button>
            <button (click)="selectLineType('pass')" class="w-full flex items-center gap-3 px-3 py-2 rounded-lg hover:bg-white/10 text-gray-300 hover:text-white transition-all text-left">
                <svg class="w-5 h-5 text-blue-400" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-dasharray="4 2"><path d="M5 12h14m-4-4l4 4-4 4" stroke-linecap="round" stroke-linejoin="round"/></svg>
                <span class="text-xs font-medium">Pase</span>
            </button>
            <button (click)="selectLineType('block')" class="w-full flex items-center gap-3 px-3 py-2 rounded-lg hover:bg-white/10 text-gray-300 hover:text-white transition-all text-left">
                <svg class="w-5 h-5 text-yellow-400" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M5 12h12m0-4v8" stroke-linecap="round" stroke-linejoin="round"/></svg>
                <span class="text-xs font-medium">Bloqueo</span>
            </button>
            
            <!-- Basket Specific Lines -->
            <ng-container *ngIf="(currentSport$ | async) === 'basketball'">
                <div class="h-px bg-white/10 my-1"></div>
                <button (click)="selectLineType('dribbling')" class="w-full flex items-center gap-3 px-3 py-2 rounded-lg hover:bg-white/10 text-gray-300 hover:text-white transition-all text-left">
                    <svg class="w-5 h-5 text-orange-400" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M4 12c2-4 4-4 6 0s4 4 6 0 4-4 6 0" stroke-linecap="round"/></svg>
                    <span class="text-xs font-medium">Correr c. Bal√≥n</span>
                </button>
                <button (click)="selectLineType('bounce-pass')" class="w-full flex items-center gap-3 px-3 py-2 rounded-lg hover:bg-white/10 text-gray-300 hover:text-white transition-all text-left">
                    <svg class="w-5 h-5 text-blue-300" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-dasharray="2 2"><path d="M4 12c3-4 6-4 9 0s6 4 9 0" stroke-linecap="round"/></svg>
                    <span class="text-xs font-medium">Pase Picado</span>
                </button>
                <button (click)="selectLineType('pivot')" class="w-full flex items-center gap-3 px-3 py-2 rounded-lg hover:bg-white/10 text-gray-300 hover:text-white transition-all text-left">
                    <svg class="w-5 h-5 text-purple-400" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M12 19a7 7 0 1 0 0-14 7 7 0 0 0 0 14zM12 5l-2 2m2-2l2 2" stroke-linecap="round" stroke-linejoin="round"/></svg>
                    <span class="text-xs font-medium">Pivote</span>
                </button>
                <button (click)="selectLineType('hand-off')" class="w-full flex items-center gap-3 px-3 py-2 rounded-lg hover:bg-white/10 text-gray-300 hover:text-white transition-all text-left">
                    <svg class="w-5 h-5 text-pink-400" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M5 12h14m-14 0l4-4m-4 4l4 4m10-8l4 4-4 4" stroke-linecap="round" stroke-linejoin="round"/></svg>
                    <span class="text-xs font-medium">C. Mano</span>
                </button>
                <button (click)="selectLineType('cut')" class="w-full flex items-center gap-3 px-3 py-2 rounded-lg hover:bg-white/10 text-gray-300 hover:text-white transition-all text-left">
                    <svg class="w-5 h-5 text-red-500" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M4 16l8-8 8 8" stroke-linecap="round" stroke-linejoin="round"/></svg>
                    <span class="text-xs font-medium">Corte</span>
                </button>
            </ng-container>

            <button (click)="selectLineType('shot')" class="w-full flex items-center gap-3 px-3 py-2 rounded-lg hover:bg-white/10 text-gray-300 hover:text-white transition-all text-left">
                <svg class="w-5 h-5 text-red-400" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3"><path d="M5 19L19 5m-9 0h9v9" stroke-linecap="round" stroke-linejoin="round"/></svg>
                <span class="text-xs font-medium">Tiro</span>
            </button>
        </div>
    </div>

    <div class="w-px h-6 bg-white/10"></div>
    
    <!-- Core Elements -->
    <div class="flex items-center gap-0.5 bg-slate-700/50 rounded-full p-0.5">
        <button (click)="setTool('ball')" 
            [class.bg-blue-500]="(activeTool$ | async) === 'ball'" 
            [class.text-white]="(activeTool$ | async) === 'ball'"
            class="w-8 h-8 rounded-full flex items-center justify-center transition-all" title="Bal√≥n">
            <span class="text-base" *ngIf="(currentSport$ | async) === 'football'">‚öΩ</span>
            <span class="text-base" *ngIf="(currentSport$ | async) === 'basketball'">üèÄ</span>
            <span class="text-base" *ngIf="(currentSport$ | async) === 'futsal'">‚öΩ</span>
            <span class="text-base" *ngIf="(currentSport$ | async) === 'handball'">ü§æ</span>
        </button>
        <button (click)="setTool('cone')" 
            [class.bg-blue-500]="(activeTool$ | async) === 'cone'" 
            [class.text-white]="(activeTool$ | async) === 'cone'"
            class="w-8 h-8 rounded-full flex items-center justify-center text-gray-400 hover:text-white hover:bg-white/10 transition-all" title="Cono">
            <span class="text-base">üî∫</span>
        </button>
    </div>
    
    <div class="w-px h-6 bg-white/10" *ngIf="(currentSport$ | async) === 'basketball'"></div>

    <!-- Basket Specific Elements -->
    <div class="flex items-center gap-0.5 bg-slate-700/50 rounded-full p-0.5" *ngIf="(currentSport$ | async) === 'basketball'">
        <!-- Primary Basketball Lines (Direct Access) -->
        <button (click)="setTool('dribbling')" 
            [class.bg-orange-500]="(activeTool$ | async) === 'dribbling'" 
            class="w-8 h-8 rounded-full flex items-center justify-center text-gray-400 hover:text-white hover:bg-white/10 transition-all font-bold text-xs" title="Dribbling">
            <svg class="w-4 h-4 text-orange-400" [class.text-white]="(activeTool$ | async) === 'dribbling'" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5"><path d="M4 12c2-4 4-4 6 0s4 4 6 0 4-4 6 0" stroke-linecap="round"/></svg>
        </button>
        <button (click)="setTool('pass')" 
            [class.bg-blue-500]="(activeTool$ | async) === 'pass'" 
            class="w-8 h-8 rounded-full flex items-center justify-center text-gray-400 hover:text-white hover:bg-white/10 transition-all font-bold text-xs" title="Pase">
            <svg class="w-4 h-4 text-blue-400" [class.text-white]="(activeTool$ | async) === 'pass'" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-dasharray="3 2"><path d="M5 12h14m-4-4l4 4-4 4" stroke-linecap="round" stroke-linejoin="round"/></svg>
        </button>
        <button (click)="setTool('movement')" 
            [class.bg-green-500]="(activeTool$ | async) === 'movement'" 
            class="w-8 h-8 rounded-full flex items-center justify-center text-gray-400 hover:text-white hover:bg-white/10 transition-all font-bold text-xs" title="Moverse">
            <svg class="w-4 h-4 text-green-400" [class.text-white]="(activeTool$ | async) === 'movement'" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5"><path d="M5 12h14m-4-4l4 4-4 4" stroke-linecap="round" stroke-linejoin="round"/></svg>
        </button>
        <button (click)="setTool('block')" 
            [class.bg-yellow-500]="(activeTool$ | async) === 'block'" 
            class="w-8 h-8 rounded-full flex items-center justify-center text-gray-400 hover:text-white hover:bg-white/10 transition-all font-bold text-xs" title="Bloqueo">
            <svg class="w-4 h-4 text-yellow-500" [class.text-white]="(activeTool$ | async) === 'block'" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5"><path d="M5 12h12m0-4v8" stroke-linecap="round" stroke-linejoin="round"/></svg>
        </button>
        <button (click)="setTool('shot')" 
            [class.bg-red-500]="(activeTool$ | async) === 'shot'" 
            class="w-8 h-8 rounded-full flex items-center justify-center text-gray-400 hover:text-white hover:bg-white/10 transition-all font-bold text-xs" title="Tiro">
            <svg class="w-4 h-4 text-red-500" [class.text-white]="(activeTool$ | async) === 'shot'" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3"><path d="M5 19L19 5m-9 0h9v9" stroke-linecap="round" stroke-linejoin="round"/></svg>
        </button>

        <div class="w-px h-5 bg-white/10 mx-1"></div>

        <button (click)="setTool('attacker')" 
            [class.bg-blue-500]="(activeTool$ | async) === 'attacker'" 
            class="w-8 h-8 rounded-full flex items-center justify-center text-gray-400 hover:text-white hover:bg-white/10 transition-all font-bold text-xs" title="Atacante">
            O
        </button>
        <button (click)="setTool('defender')" 
            [class.bg-blue-500]="(activeTool$ | async) === 'defender'" 
            class="w-8 h-8 rounded-full flex items-center justify-center text-gray-400 hover:text-white hover:bg-white/10 transition-all font-bold text-xs" title="Defensor">
            X
        </button>
        <button (click)="setTool('coach')" 
            [class.bg-blue-500]="(activeTool$ | async) === 'coach'" 
            class="w-8 h-8 rounded-full flex items-center justify-center text-gray-400 hover:text-white hover:bg-white/10 transition-all font-bold text-xs" title="Entrenador">
            E
        </button>
        <button (click)="setTool('rebound')" 
            [class.bg-blue-500]="(activeTool$ | async) === 'rebound'" 
            class="w-8 h-8 rounded-full flex items-center justify-center text-gray-400 hover:text-white hover:bg-white/10 transition-all font-bold text-xs" title="Rebote">
            R
        </button>
        <button (click)="setTool('jump-stop-1')" 
            [class.bg-blue-500]="(activeTool$ | async) === 'jump-stop-1'" 
            class="w-8 h-8 rounded-full flex items-center justify-center text-gray-400 hover:text-white hover:bg-white/10 transition-all text-sm" title="Parada 1t">
            <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><rect x="6" y="6" width="12" height="12" stroke-width="2"/></svg>
        </button>
        <button (click)="setTool('jump-stop-2')" 
            [class.bg-blue-500]="(activeTool$ | async) === 'jump-stop-2'" 
            class="w-8 h-8 rounded-full flex items-center justify-center text-gray-400 hover:text-white hover:bg-white/10 transition-all text-sm" title="Parada 2t">
            <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><rect x="4" y="8" width="7" height="8" stroke-width="2"/><rect x="13" y="8" width="7" height="8" stroke-width="2"/></svg>
        </button>
        <button (click)="setTool('sequence')" 
            [class.bg-blue-500]="(activeTool$ | async) === 'sequence'" 
            class="w-8 h-8 rounded-full flex items-center justify-center text-gray-400 hover:text-white hover:bg-white/10 transition-all" title="Secuencia">
            <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><circle cx="12" cy="12" r="8" stroke-width="2"/><text x="12" y="16" text-anchor="middle" font-size="10" font-weight="bold" fill="currentColor">1</text></svg>
        </button>
    </div>

    <div class="w-px h-6 bg-white/10"></div>

    <!-- View/Sport Toggle -->
    <div class="flex items-center gap-0.5 bg-slate-700/50 rounded-full p-0.5">
        <button (click)="setViewMode('full')" 
            [class.bg-white/20]="(viewMode$ | async) === 'full'"
            class="px-2 py-1 rounded-full text-[10px] font-bold uppercase text-gray-400 hover:text-white transition-all"
            [class.text-white]="(viewMode$ | async) === 'full'">
            Full
        </button>
        <button (click)="setViewMode('half')" 
            [class.bg-white/20]="(viewMode$ | async) === 'half'"
            class="px-2 py-1 rounded-full text-[10px] font-bold uppercase text-gray-400 hover:text-white transition-all"
            [class.text-white]="(viewMode$ | async) === 'half'">
            ¬Ω
        </button>
    </div>

    <div class="w-px h-6 bg-white/10"></div>

    <!-- Sport Selector -->
    <div class="flex items-center gap-0.5 bg-slate-700/50 rounded-full p-0.5">
        <button (click)="setSport('football')" 
            [class.bg-emerald-500]="(currentSport$ | async) === 'football'"
            class="w-7 h-7 rounded-full flex items-center justify-center text-sm transition-all">
            ‚öΩ
        </button>
        <button (click)="setSport('basketball')" 
            [class.bg-orange-500]="(currentSport$ | async) === 'basketball'"
            class="w-7 h-7 rounded-full flex items-center justify-center text-sm transition-all">
            üèÄ
        </button>
    </div>

</div>
