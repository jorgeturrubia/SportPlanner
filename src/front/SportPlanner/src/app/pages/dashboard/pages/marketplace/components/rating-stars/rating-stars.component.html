<div class="flex items-center gap-2">
  <!-- Stars Container -->
  <div 
    class="flex items-center gap-1"
    [class]="sizeClasses()"
    (mouseleave)="onStarsLeave()"
    [attr.role]="interactive ? 'slider' : null"
    [attr.aria-label]="getAriaLabel()"
    [attr.aria-valuenow]="interactive ? selectedStar() : rating"
    [attr.aria-valuemin]="interactive ? 1 : null"
    [attr.aria-valuemax]="interactive ? 5 : null"
    [attr.tabindex]="interactive && !disabled ? 0 : null"
    (keydown)="onKeyDown($event)"
  >
    @for (star of stars(); track star) {
      <svg
        class="star-icon"
        [class]="getStarClasses(star)"
        (mouseenter)="onStarHover(star)"
        (click)="onStarClick(star)"
        viewBox="0 0 24 24"
        xmlns="http://www.w3.org/2000/svg"
        [attr.aria-hidden]="true"
      >
        @if (isStarFilled(star)) {
          <!-- Filled star -->
          <path d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z" />
        } @else if (isStarHalfFilled(star)) {
          <!-- Half-filled star -->
          <defs>
            <linearGradient id="half-fill-{{ star }}">
              <stop offset="50%" stop-color="currentColor" />
              <stop offset="50%" stop-color="transparent" />
            </linearGradient>
          </defs>
          <path 
            d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z" 
            [attr.fill]="'url(#half-fill-' + star + ')'"
            stroke="currentColor"
            stroke-width="1"
          />
        } @else {
          <!-- Empty star -->
          <path 
            d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z" 
            fill="none" 
            stroke="currentColor" 
            stroke-width="1"
          />
        }
      </svg>
    }
  </div>

  <!-- Rating Text -->
  @if (showCount || !interactive) {
    <span class="rating-text text-gray-600 font-medium" [class]="sizeClasses()">
      {{ getRatingText() }}
    </span>
  }

  <!-- Interactive Instructions -->
  @if (interactive && !disabled) {
    <span class="sr-only">
      Usa las flechas para navegar y Enter para seleccionar una valoraci√≥n
    </span>
  }
</div>